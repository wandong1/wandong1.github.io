<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>lvm逻辑卷管理 | 万东的云计算运维博客</title><meta name=keywords content="linux"><meta name=description content="LVM的工作原理 LVM（ Logical Volume Manager）逻辑卷管理，是在磁盘分区和文件系统之间添加的一个逻辑层，来为文件系统屏蔽下层磁盘分区布局，提供一个抽象的盘卷，在盘卷上建立文件系统。管理员利用LVM可以在磁盘不用重新分区的情况下动态调整文件系统的大小，并且利用LVM管理的文件系统可以跨越磁盘，当服务器添加了新的磁盘后，管理员不必将原有的文件移动到新的磁盘上，而是通过LVM可以直接扩展文件系统跨越磁盘
它就是通过将底层的物理硬盘封装起来，然后以逻辑卷的方式呈现给上层应用。在LVM中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不再是针对于分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。
LVM常用的术语 物理存储介质（The physical media）:LVM存储介质可以是磁盘分区，整个磁盘，RAID阵列或SAN磁盘，设备必须初始化为LVM物理卷，才能与LVM结合使用
物理卷PV（physical volume） ：物理卷就是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数,创建物理卷它可以用硬盘分区，也可以用硬盘本身；
卷组VG（Volume Group） ：一个LVM卷组由一个或多个物理卷组成 
逻辑卷LV（logical volume） ：LV建立在VG之上，可以在LV之上建立文件系统
PE（physical extents） ：PV物理卷中可以分配的最小存储单元，PE的大小是可以指定的，默认为4MB
LE（logical extent） ： LV逻辑卷****中可以分配的最小存储单元，在同一个卷组中，LE的大小和PE是相同的，并且一一对应
最小存储单位总结：
名称 最小存储单位
硬盘 扇区（512字节）
文件系统 block（1K或4K ）# mkfs.ext4 -b 2048 /dev/sdb1 ，最大支持到4096
raid chunk （512K） #mdadm -C -v /dev/md5 -l 5 -n 3 -c 512 -x 1 /dev/sde{1,2,3,5}
LVM PE （4M） # vgcreate -s 4M vg1 /dev/sdb{1,2}
LVM主要元素构成： 总结：多个磁盘/分区/raid-》多个物理卷PV-》合成卷组VG-》从VG划出逻辑卷LV-》格式化LV挂载使用
LVM优点 使用卷组，使多个硬盘空间看起来像是一个大的硬盘
使用逻辑卷，可以跨多个硬盘空间的分区 sdb1 sdb2 sdc1 sdd2 sdf"><meta name=author content="Me"><link rel=canonical href=https://wandong1.github.io/post/lvm%E9%80%BB%E8%BE%91%E5%8D%B7%E7%AE%A1%E7%90%86/><link crossorigin=anonymous href=/assets/css/stylesheet.min.77d563e104d7b39d673d4f21adf63da1ad0244dbcd78291ac2b44dc25b0066e1.css integrity="sha256-d9Vj4QTXs51nPU8hrfY9oa0CRNvNeCkawrRNwlsAZuE=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wandong1.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://wandong1.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://wandong1.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://wandong1.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://wandong1.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="lvm逻辑卷管理"><meta property="og:description" content="LVM的工作原理 LVM（ Logical Volume Manager）逻辑卷管理，是在磁盘分区和文件系统之间添加的一个逻辑层，来为文件系统屏蔽下层磁盘分区布局，提供一个抽象的盘卷，在盘卷上建立文件系统。管理员利用LVM可以在磁盘不用重新分区的情况下动态调整文件系统的大小，并且利用LVM管理的文件系统可以跨越磁盘，当服务器添加了新的磁盘后，管理员不必将原有的文件移动到新的磁盘上，而是通过LVM可以直接扩展文件系统跨越磁盘
它就是通过将底层的物理硬盘封装起来，然后以逻辑卷的方式呈现给上层应用。在LVM中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不再是针对于分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。
LVM常用的术语 物理存储介质（The physical media）:LVM存储介质可以是磁盘分区，整个磁盘，RAID阵列或SAN磁盘，设备必须初始化为LVM物理卷，才能与LVM结合使用
物理卷PV（physical volume） ：物理卷就是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数,创建物理卷它可以用硬盘分区，也可以用硬盘本身；
卷组VG（Volume Group） ：一个LVM卷组由一个或多个物理卷组成 
逻辑卷LV（logical volume） ：LV建立在VG之上，可以在LV之上建立文件系统
PE（physical extents） ：PV物理卷中可以分配的最小存储单元，PE的大小是可以指定的，默认为4MB
LE（logical extent） ： LV逻辑卷****中可以分配的最小存储单元，在同一个卷组中，LE的大小和PE是相同的，并且一一对应
最小存储单位总结：
名称 最小存储单位
硬盘 扇区（512字节）
文件系统 block（1K或4K ）# mkfs.ext4 -b 2048 /dev/sdb1 ，最大支持到4096
raid chunk （512K） #mdadm -C -v /dev/md5 -l 5 -n 3 -c 512 -x 1 /dev/sde{1,2,3,5}
LVM PE （4M） # vgcreate -s 4M vg1 /dev/sdb{1,2}
LVM主要元素构成： 总结：多个磁盘/分区/raid-》多个物理卷PV-》合成卷组VG-》从VG划出逻辑卷LV-》格式化LV挂载使用
LVM优点 使用卷组，使多个硬盘空间看起来像是一个大的硬盘
使用逻辑卷，可以跨多个硬盘空间的分区 sdb1 sdb2 sdc1 sdd2 sdf"><meta property="og:type" content="article"><meta property="og:url" content="https://wandong1.github.io/post/lvm%E9%80%BB%E8%BE%91%E5%8D%B7%E7%AE%A1%E7%90%86/"><meta property="og:image" content="https://wandong1.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wandong1.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="lvm逻辑卷管理"><meta name=twitter:description content="LVM的工作原理 LVM（ Logical Volume Manager）逻辑卷管理，是在磁盘分区和文件系统之间添加的一个逻辑层，来为文件系统屏蔽下层磁盘分区布局，提供一个抽象的盘卷，在盘卷上建立文件系统。管理员利用LVM可以在磁盘不用重新分区的情况下动态调整文件系统的大小，并且利用LVM管理的文件系统可以跨越磁盘，当服务器添加了新的磁盘后，管理员不必将原有的文件移动到新的磁盘上，而是通过LVM可以直接扩展文件系统跨越磁盘
它就是通过将底层的物理硬盘封装起来，然后以逻辑卷的方式呈现给上层应用。在LVM中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不再是针对于分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。
LVM常用的术语 物理存储介质（The physical media）:LVM存储介质可以是磁盘分区，整个磁盘，RAID阵列或SAN磁盘，设备必须初始化为LVM物理卷，才能与LVM结合使用
物理卷PV（physical volume） ：物理卷就是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数,创建物理卷它可以用硬盘分区，也可以用硬盘本身；
卷组VG（Volume Group） ：一个LVM卷组由一个或多个物理卷组成 
逻辑卷LV（logical volume） ：LV建立在VG之上，可以在LV之上建立文件系统
PE（physical extents） ：PV物理卷中可以分配的最小存储单元，PE的大小是可以指定的，默认为4MB
LE（logical extent） ： LV逻辑卷****中可以分配的最小存储单元，在同一个卷组中，LE的大小和PE是相同的，并且一一对应
最小存储单位总结：
名称 最小存储单位
硬盘 扇区（512字节）
文件系统 block（1K或4K ）# mkfs.ext4 -b 2048 /dev/sdb1 ，最大支持到4096
raid chunk （512K） #mdadm -C -v /dev/md5 -l 5 -n 3 -c 512 -x 1 /dev/sde{1,2,3,5}
LVM PE （4M） # vgcreate -s 4M vg1 /dev/sdb{1,2}
LVM主要元素构成： 总结：多个磁盘/分区/raid-》多个物理卷PV-》合成卷组VG-》从VG划出逻辑卷LV-》格式化LV挂载使用
LVM优点 使用卷组，使多个硬盘空间看起来像是一个大的硬盘
使用逻辑卷，可以跨多个硬盘空间的分区 sdb1 sdb2 sdc1 sdd2 sdf"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://wandong1.github.io/post/"},{"@type":"ListItem","position":3,"name":"lvm逻辑卷管理","item":"https://wandong1.github.io/post/lvm%E9%80%BB%E8%BE%91%E5%8D%B7%E7%AE%A1%E7%90%86/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"lvm逻辑卷管理","name":"lvm逻辑卷管理","description":"LVM的工作原理 LVM（ Logical Volume Manager）逻辑卷管理，是在磁盘分区和文件系统之间添加的一个逻辑层，来为文件系统屏蔽下层磁盘分区布局，提供一个抽象的盘卷，在盘卷上建立文件系统。管理员利用LVM可以在磁盘不用重新分区的情况下动态调整文件系统的大小，并且利用LVM管理的文件系统可以跨越磁盘，当服务器添加了新的磁盘后，管理员不必将原有的文件移动到新的磁盘上，而是通过LVM可以直接扩展文件系统跨越磁盘\n它就是通过将底层的物理硬盘封装起来，然后以逻辑卷的方式呈现给上层应用。在LVM中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不再是针对于分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。\nLVM常用的术语 物理存储介质（The physical media）:LVM存储介质可以是磁盘分区，整个磁盘，RAID阵列或SAN磁盘，设备必须初始化为LVM物理卷，才能与LVM结合使用\n物理卷PV（physical volume） ：物理卷就是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数,创建物理卷它可以用硬盘分区，也可以用硬盘本身；\n卷组VG（Volume Group） ：一个LVM卷组由一个或多个物理卷组成 \n逻辑卷LV（logical volume） ：LV建立在VG之上，可以在LV之上建立文件系统\nPE（physical extents） ：PV物理卷中可以分配的最小存储单元，PE的大小是可以指定的，默认为4MB\nLE（logical extent） ： LV逻辑卷****中可以分配的最小存储单元，在同一个卷组中，LE的大小和PE是相同的，并且一一对应\n最小存储单位总结：\n名称 最小存储单位\n硬盘 扇区（512字节）\n文件系统 block（1K或4K ）# mkfs.ext4 -b 2048 /dev/sdb1 ，最大支持到4096\nraid chunk （512K） #mdadm -C -v /dev/md5 -l 5 -n 3 -c 512 -x 1 /dev/sde{1,2,3,5}\nLVM PE （4M） # vgcreate -s 4M vg1 /dev/sdb{1,2}\nLVM主要元素构成： 总结：多个磁盘/分区/raid-》多个物理卷PV-》合成卷组VG-》从VG划出逻辑卷LV-》格式化LV挂载使用\nLVM优点 使用卷组，使多个硬盘空间看起来像是一个大的硬盘\n使用逻辑卷，可以跨多个硬盘空间的分区 sdb1 sdb2 sdc1 sdd2 sdf","keywords":["linux"],"articleBody":"LVM的工作原理 LVM（ Logical Volume Manager）逻辑卷管理，是在磁盘分区和文件系统之间添加的一个逻辑层，来为文件系统屏蔽下层磁盘分区布局，提供一个抽象的盘卷，在盘卷上建立文件系统。管理员利用LVM可以在磁盘不用重新分区的情况下动态调整文件系统的大小，并且利用LVM管理的文件系统可以跨越磁盘，当服务器添加了新的磁盘后，管理员不必将原有的文件移动到新的磁盘上，而是通过LVM可以直接扩展文件系统跨越磁盘\n它就是通过将底层的物理硬盘封装起来，然后以逻辑卷的方式呈现给上层应用。在LVM中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不再是针对于分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。\nLVM常用的术语 物理存储介质（The physical media）:LVM存储介质可以是磁盘分区，整个磁盘，RAID阵列或SAN磁盘，设备必须初始化为LVM物理卷，才能与LVM结合使用\n物理卷PV（physical volume） ：物理卷就是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数,创建物理卷它可以用硬盘分区，也可以用硬盘本身；\n卷组VG（Volume Group） ：一个LVM卷组由一个或多个物理卷组成 \n逻辑卷LV（logical volume） ：LV建立在VG之上，可以在LV之上建立文件系统\nPE（physical extents） ：PV物理卷中可以分配的最小存储单元，PE的大小是可以指定的，默认为4MB\nLE（logical extent） ： LV逻辑卷****中可以分配的最小存储单元，在同一个卷组中，LE的大小和PE是相同的，并且一一对应\n最小存储单位总结：\n名称 最小存储单位\n硬盘 扇区（512字节）\n文件系统 block（1K或4K ）# mkfs.ext4 -b 2048 /dev/sdb1 ，最大支持到4096\nraid chunk （512K） #mdadm -C -v /dev/md5 -l 5 -n 3 -c 512 -x 1 /dev/sde{1,2,3,5}\nLVM PE （4M） # vgcreate -s 4M vg1 /dev/sdb{1,2}\nLVM主要元素构成： 总结：多个磁盘/分区/raid-》多个物理卷PV-》合成卷组VG-》从VG划出逻辑卷LV-》格式化LV挂载使用\nLVM优点 使用卷组，使多个硬盘空间看起来像是一个大的硬盘\n使用逻辑卷，可以跨多个硬盘空间的分区 sdb1 sdb2 sdc1 sdd2 sdf\n在使用逻辑卷时，它可以在空间不足时动态调整它的大小\n在调整逻辑卷大小时，不需要考虑逻辑卷在硬盘上的位置，不用担心没有可用的连续空间\n可以在线对LV,VG 进行创建，删除，调整大小等操作。LVM上的文件系统也需要重新调整大小。\n允许创建快照，可以用来保存文件系统的备份。\nRAID+LVM一起用：LVM是软件的卷管理方式，而RAID是磁盘管理的方法。对于重要的数据，使用RAID来保护物理的磁盘不会因为故障而中断业务，再用LVM用来实现对卷的良性的管理，更好的利用磁盘资源。\n创建LVM的基本步骤 1) 物理磁盘被格式化为PV，(空间被划分为一个个的PE) #PV包含PE\n2) 不同的PV加入到同一个VG中，(不同PV的PE全部进入到了VG的PE池内) #VG包含PV\n3) 在VG中创建LV逻辑卷，基于PE创建，(组成LV的PE可能来自不同的物理磁盘) #LV基于PE创建\n4) LV直接可以格式化后挂载使用 #格式化挂载使用\n5) LV的扩充缩减实际上就是增加或减少组成该LV的PE数量，其过程不会丢失原始数据\nlvm常用的命令 下面的操作会用的一些查看命令：\n创建并使用LVM逻辑卷\n1、 创建PV 添加一个sdb磁盘\n[root@xuegod63 ~]# fdisk /dev/sdb #创建4个主分区，每个分区1G [root@xuegod63 ~]# ls /dev/sdb\\ /dev/sdb /dev/sdb1 /dev/sdb2 /dev/sdb3 /dev/sdb4 #设定分区类型代码：fdisk /dev/sdb ===\u003e t ===\u003e 选择分区号 ====\u003e 8e ====\u003e w #注：现在系统已经很智能了， 直接使用默认的 83 Linux分区，也可以创建pv的。 [root@xuegod63 ~]# pvcreate /dev/sdb{1,2,3,4} #创建pv Physical volume \"/dev/sdb1\" successfully created. Physical volume \"/dev/sdb2\" successfully created. Physical volume \"/dev/sdb3\" successfully created. Physical volume \"/dev/sdb4\" successfully created. [root@xuegod63 ~]# pvdisplay /dev/sdb1 #查看物理卷信息 \"/dev/sdb1\" is a new physical volume of \"1.00 GiB\" --- NEW Physical volume --- PV Name /dev/sdb1 VG Name PV Size 1.00 GiB Allocatable NO PE Size 0 Total PE 0 Free PE 0 Allocated PE 0 PV UUID SHKFwf-WsLr-kkox-wlee-dAXc-5eL0-hyhaTV 2、创建vg卷组： # 语法： vgcreate vg名字 pv的名字 可以跟多个pv [root@xuegod63 ~]# vgcreate vg01 /dev/sdb1 Volume group \"vg01\" successfully created [root@xuegod63 ~]# vgs VG #PV #LV #SN Attr VSize VFree vg01 1 0 0 wz--n- 1020.00m 1020.00m [root@xuegod63 ~]# vgdisplay vg01 --- Volume group --- VG Name vg01 System ID Format lvm2 Metadata Areas 1 Metadata Sequence No 1 VG Access read/write VG Status resizable MAX LV 0 Cur LV 0 Open LV 0 Max PV 0 Cur PV 1 Act PV 1 VG Size 1020.00 MiB PE Size 4.00 MiB Total PE 255 Alloc PE / Size 0 / 0 3、创建LV lvcreate -n 指定新逻辑卷的名称 -L指定lv大小的SIZE(M,G) （-l：小l 指定LE的数量） vgname [root@xuegod63 ~]# lvcreate -n lv01 -L 16M vg01 Logical volume \"lv01\" created. [root@xuegod63 ~]# lvcreate -n lv02 -l 4 vg01 Logical volume \"lv02\" created. [root@xuegod63 ~]# lvs LV VG Attr LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert lv01 vg01 -wi-a----- 16.00m lv02 vg01 -wi-a----- 16.00m [root@xuegod63 ~]# pvdisplay /dev/sdb1 --- Physical volume --- PV Name /dev/sdb1 VG Name vg01 PV Size 1.00 GiB / not usable 4.00 MiB Allocatable yes PE Size 4.00 MiB Total PE 255 Free PE 247 Allocated PE 8 # Allocated ['æləkeɪtɪd] 分配 ，已经使用了8个PE [root@xuegod63 ~]# vgdisplay vg01 Alloc PE / Size 8 / 32.00 MiB #已经使用8个PE，32MB Free PE / Size 247 / 988.00 MiB 4、文件系统格式与挂载 [root@xuegod63 ~]# mkdir /lv01 互动： lv01 逻辑卷的路径在哪？ [root@xuegod63 ~]# ls /dev/vg01/ #查看逻辑卷 lv01 lv02 [root@xuegod63 ~]# ll /dev/vg01/lv01 #其实lv01是dm-0的软链接 lrwxrwxrwx 1 root root 7 5月 18 19:02 /dev/vg01/lv01 -\u003e ../dm-0 [root@xuegod63 ~]# mkfs.ext4 /dev/vg01/lv01 [root@xuegod63 ~]# mount /dev/vg01/lv01 /lv01 [root@xuegod63 ~]# df -Th /lv01 文件系统 类型 容量 已用 可用 已用% 挂载点 /dev/mapper/vg01-lv01 ext4 15M 268K 14M 2% /lv01 [root@xuegod63 ~]#echo \"/dev/vg01/lv01 /lv01 ext4 defaults 0 0\" \u003e\u003e /etc/fstab 5、指定PE大小用 指定PE大小用的参数： -s ,如果存储的数据都是大文件，那么PE尽量调大，读取速度快\n[root@xuegod63 ~]# vgcreate -s 16M vg02 /dev/sdb2 Volume group \"vg02\" successfully created # PE的大小只有为2的幂数，且最大为512M [root@xuegod63 ~]# vgdisplay vg02 --- Volume group --- VG Name vg02 System ID Format lvm2 Metadata Areas 1 Metadata Sequence No 1 VG Access read/write VG Status resizable MAX LV 0 Cur LV 0 Open LV 0 Max PV 0 Cur PV 1 Act PV 1 VG Size 1008.00 MiB PE Size 16.00 MiB #已经是16MB** 6、LV扩容 首先，确定一下是否有可用的扩容空间，因为空间是从VG里面创建的，并且LV不能跨VG扩容\n[root@xuegod63 ~]# vgs VG #PV #LV #SN Attr VSize VFree vg01 1 2 0 wz--n- 1020.00m 988.00m vg02 1 0 0 wz--n- 1008.00m 1008.00m** 用的命令如下：\n扩容逻辑卷\n[root@xuegod63 ~]# lvextend -L +30m /dev/vg01/lv01 说明：在指定大小的时候，扩容30m和扩容到30m是不一样的写法\n扩容30m ====\u003e -L +30M\n扩容到30m =====\u003e -L 30M\n[root@xuegod63 ~]# lvextend -L +30m /dev/vg01/lv01 Rounding size to boundary between physical extents: 32.00 MiB. Size of logical volume vg01/lv01 changed from 16.00 MiB (4 extents) to 48.00 MiB (12 extents). Logical volume vg01/lv01 successfully resized.** [root@xuegod63 ~]# lvs LV VG Attr LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert lv01 vg01 -wi-ao---- 48.00m #LV已经扩容成功 lv02 vg01 -wi-a----- 16.00m [root@xuegod63 ~]# df -Th /lv01 文件系统 类型 容量 已用 可用 已用% 挂载点 /dev/mapper/vg01-lv01 ext4 15M 268K 14M 2% /lv01 注：可以看到LV虽然扩展了，但是文件系统大小还是原来的，下面开始扩容文件系统\next4文件系统扩容使用命令语法： resize2fs 逻辑卷名称\nxfs文件系统扩容使用命令语法： xfs_growfs 挂载点 xfs_growfs /var/\nresize2fs和xfs_growfs 两者的区别是传递的参数不一样的，xfs_growfs是采用的挂载点；resize2fs是逻辑卷名称，而且resize2fs命令不能对xfs类型文件系统使用\n[root@xuegod63 ~]# resize2fs /dev/vg01/lv01 resize2fs 1.42.9 (28-Dec-2013) Filesystem at /dev/vg01/lv01 is mounted on /lv01; on-line resizing required old_desc_blocks = 1, new_desc_blocks = 1 The filesystem on /dev/vg01/lv01 is now 49152 blocks long. [root@xuegod63 ~]# df -Th /lv01 文件系统 类型 容量 已用 可用 已用% 挂载点 /dev/mapper/vg01-lv01 ext4 46M （扩容成功）522K 43M 2% /lv01 [root@xuegod63 ~]# lvextend -L 80M -r /dev/vg01/lv01 #直接扩容到80M空间，一步到位，不用再扩文件系统了 [root@xuegod63 ~]# df -T /lv01/ 文件系统 类型 1K-块 已用 可用 已用% 挂载点 /dev/mapper/vg01-lv01 ext4 78303 776 73761 2% /lv01 [root@xuegod63 ~]# df -Th /lv01/ 文件系统 类型 容量 已用 可用 已用% 挂载点 /dev/mapper/vg01-lv01 ext4 77M 776K 73M 2% /lv01** 7、VG扩容 [root@xuegod63 ~]# vgs VG #PV #LV #SN Attr VSize VFree vg01 1 2 0 wz--n- 1020.00m 924.00m vg02 1 0 0 wz--n- 1008.00m 1008.00m # vg扩容的场景：vg卷组中的空间不了够，需要添加新的硬盘进来 [root@xuegod63 ~]# pvcreate /dev/sdb3 # 创建pv [root@xuegod63 ~]# vgextend vg01 /dev/sdb3 #扩容成功 Volume group \"vg01\" successfully extended [root@xuegod63 ~]# vgs VG #PV #LV #SN Attr VSize VFree vg01 2 2 0 wz--n- 1.99g \u003c1.90g vg02 1 0 0 wz--n- 1008.00m 1008.00m 8、LVM缩小 互动：LVM可以动态增加，可以动态缩小吗？\n答：LVM可以动态增加，也可以动态缩小，但是XFS不支持动态缩小，所以我们无法实现基于xfs的动态缩小。btrfs文件系统支持在线缩小。\n[root@xuegod63 ~]# lvreduce -L -20m /dev/vg01/lv01 WARNING: Reducing active and open logical volume to 60.00 MiB. THIS MAY DESTROY YOUR DATA (filesystem etc.) Do you really want to reduce vg01/lv01? [y/n]: y Size of logical volume vg01/lv01 changed from 80.00 MiB (20 extents) to 60.00 MiB (15 extents). Logical volume vg01/lv01 successfully resized. #缩小成功** 但是文件系统没有缩小成功：\n[root@xuegod63 ~]# df -h /lv01/ 文件系统 容量 已用 可用 已用% 挂载点 /dev/mapper/vg01-lv01 77M 776K 73M 2% /lv01 #发现文件系统上空间没有变 [root@xuegod63 ~]# lvextend -L 10M -r /dev/vg01/lv01 #这两个命令也是不能执行成功的 [root@xuegod63 ~]# resize2fs /dev/vg01/lv01 #这两个命令也是不能执行成功的 VG的缩减，要保证你的物理卷是否被使用，是因为它无法缩减一个正在使用的PV\n[root@xuegod63 ~]# vgs VG #PV #LV #SN Attr VSize VFree vg01 2 2 0 wz--n- 1.99g \u003c1.92g vg02 1 0 0 wz--n- 1008.00m 1008.00m [root@xuegod63 ~]# pvs PV VG Fmt Attr PSize PFree /dev/sdb1 vg01 lvm2 a-- 1020.00m 944.00m /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m /dev/sdb3 vg01 lvm2 a-- 1020.00m 1020.00m /dev/sdb4 lvm2 --- 1.00g 1.00g [root@xuegod63 ~]# cp -r /boot/grub /lv01/ #复制一些测试数据 [root@xuegod63 ~]# vgreduce vg01 /dev/sdb1 #将sdb1移出失败，因sdb1正在被使用 Physical volume \"/dev/sdb1\" still in use** 互动：如果sdb1是一个磁盘阵列，而这个磁盘阵列使用年代太久，我们必须移出怎么办？\n移动数据：\n[root@xuegod63 ~]# pvmove /dev/sdb1 /dev/sdb3 #将sdb1上数据移到新增加sdb3 pv 上 /dev/sdb1: Moved: 23.53% /dev/sdb1: Moved: 76.47% /dev/sdb1: Moved: 100.00% [root@xuegod63 ~]# vgreduce vg01 /dev/sdb1 #移完数据再移出 Removed \"/dev/sdb1\" from volume group \"vg01\" [root@xuegod63 ~]# pvs PV VG Fmt Attr PSize PFree /dev/sdb1 lvm2 --- 1.00g 1.00g /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m /dev/sdb3 vg01 lvm2 a-- 1020.00m 952.00m #vg01中只有sdb3了 9、 LVM删除 创建LVM流程:\npvcreate创建pv -\u003e vgcreate创建卷组 -\u003e lvcreate创建逻辑卷 -\u003e mkfs.xfs lv 格式化-\u003e mount挂载\n删除LVM流程：\numount卸载 -\u003e lvremove lv移出卷组中所有逻辑卷-\u003e vgremove vg移出卷组-\u003e pvremove 移出pv\n[root@xuegod63 ~]# umount /lv01 [root@xuegod63 ~]# lvremove /dev/vg01/lv01 Do you really want to remove active logical volume vg01/lv01? [y/n]: y Logical volume \"lv01\" successfully removed [root@xuegod63 ~]# lvs LV VG Attr LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert lv02 vg01 -wi-a----- 16.00m #已经看不到lv01 [root@xuegod63 ~]# vgremove vg01 #直接移出卷组 Do you really want to remove volume group \"vg01\" containing 1 logical volumes? [y/n]: y Do you really want to remove active logical volume vg01/lv02? [y/n]: y #如果卷组中还有lv，移出时，会提示，是否也移出，咱们这里直接移出 Logical volume \"lv02\" successfully removed Volume group \"vg01\" successfully removed [root@xuegod63 ~]# vgs VG #PV #LV #SN Attr VSize VFree vg02 1 0 0 wz--n- 1008.00m 1008.00m #没有vg01 移出pv sdb1\n[root@xuegod63 ~]# pvs PV VG Fmt Attr PSize PFree /dev/sdb1 lvm2 --- 1.00g 1.00g /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m /dev/sdb3 lvm2 --- 1.00g 1.00g /dev/sdb4 lvm2 --- 1.00g 1.00g [root@xuegod63 ~]# pvremove /dev/sdb1 #已经移出 Labels on physical volume \"/dev/sdb1\" successfully wiped. [root@xuegod63 ~]# pvs PV VG Fmt Attr PSize PFree /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m /dev/sdb3 lvm2 --- 1.00g 1.00g /dev/sdb4 lvm2 --- 1.00g 1.00g 15.3 实战-使用SSM工具为公司的邮件服务器创建可动态扩容的存储池\n安装SSM ssm工具了一下\n[root@xuegod63 ~]# yum -y install system-storage-manager\nSSM：检查关于可用硬驱和LVM卷的信息。显示关于现有磁盘存储设备、存储池、LVM卷和存储快照的信息。\n15.3.1 查看磁盘信息\n列出设备信息\nroot@xuegod63 ~]# ssm list dev\n————————————————————\nDevice Free Used Total Pool Mount point\n————————————————————\n/dev/fd0 4.00 KB\n/dev/sda 20.00 GB PARTITIONED\n/dev/sda1 200.00 MB /boot\n/dev/sda2 1.00 GB SWAP\n/dev/sda3 10.00 GB /\n/dev/sdb 20.00 GB\n/dev/sdb1 1.00 GB\n/dev/sdb2 1008.00 MB 0.00 KB 1.00 GB vg02\n/dev/sdb3 1.00 GB\n/dev/sdb4 1.00 GB\n存储池信息\n[root@xuegod63 ~]# ssm list pool\n—————————————————-\nPool Type Devices Free Used Total\n—————————————————-\nvg02 lvm 1 1008.00 MB 0.00 KB 1008.00 MB\n—————————————————-\n15.3.2 实战：为公司的邮件服务器创建基于LVM的邮件存储\n实战场景：公司要搭建一台邮件服务器，考虑到后期公司发展规模扩张，需要你创建一个名为mail 的LVM存储池，并在其上创建一个名为mail-lv，初始大小为1G的lvm卷，格式化为xfs文件系统，并将其挂载/mail-lv目录下。此存储池中的空间后期要可以动态扩容。\n将sdb上所有卷组信息删除：\n[root@xuegod63 ~]# vgremove vg02\n[root@xuegod63 ~]# pvremove /dev/sdb{1,2,3,4}\n创建目录\n[root@xuegod72 ~]# mkdir /mail-lv\n用的命令如下：\nssm create -s lv大小 -n lv名称 –fstype lv文件系统类型 -p 卷组名 设备 挂载点\n自动把设备变成pv，创建vg , lv ,格式化文件系统, 自动挂载\n[root@xuegod63 ~]# ssm create -s 1G -n mail-lv –fstype xfs -p mail /dev/sdb[1-4] /mail-lv\nPhysical volume “/dev/sdb1” successfully created.\nPhysical volume “/dev/sdb2” successfully created.\nPhysical volume “/dev/sdb3” successfully created.\nPhysical volume “/dev/sdb4” successfully created.\nVolume group “mail” successfully created\nWARNING: ext4 signature detected on /dev/mail/mail-lv at offset 1080. Wipe it? [y/n]: y\nWiping ext4 signature on /dev/mail/mail-lv.\nLogical volume “mail-lv” created.\nmeta-data=/dev/mail/mail-lv isize=512 agcount=4, agsize=65536 blks\n​ = sectsz=512 attr=2, projid32bit=1\n​ = crc=1 finobt=0, sparse=0\ndata = bsize=4096 blocks=262144, imaxpct=25\n​ = sunit=0 swidth=0 blks\nnaming =version 2 bsize=4096 ascii-ci=0 ftype=1\nlog =internal log bsize=4096 blocks=2560, version=2\n​ = sectsz=512 sunit=0 blks, lazy-count=1\nrealtime =none extsz=4096 blocks=0, rtextents=0\n[root@xuegod63 ~]# df -h /mail-lv/\n文件系统 容量 已用 可用 已用% 挂载点\n/dev/mapper/mail-mail–lv 1014M 33M 982M 4% /mail-lv\n总结：\n15.1 LVM的工作原理\n15.2 创建LVM的基本步骤\n15.3 实战-使用SSM工具为公司的邮件服务器创建可动态扩容的存储池\n","wordCount":"1537","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wandong1.github.io/post/lvm%E9%80%BB%E8%BE%91%E5%8D%B7%E7%AE%A1%E7%90%86/"},"publisher":{"@type":"Organization","name":"万东的云计算运维博客","logo":{"@type":"ImageObject","url":"https://wandong1.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wandong1.github.io accesskey=h title="万东的云计算运维博客 (Alt + H)"><img src=https://wandong1.github.io/img-icon.png alt=logo aria-label=logo height=35>万东的云计算运维博客</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://wandong1.github.io/categories/ title=分类><span>分类</span></a></li><li><a href=https://wandong1.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://wandong1.github.io/archives/ title=归档><span>归档</span></a></li><li><a href=https://wandong1.github.io/search title=搜索><span>搜索</span></a></li></ul></nav></header><main class="main page"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wandong1.github.io>Home</a>&nbsp;»&nbsp;<a href=https://wandong1.github.io/post/>Posts</a></div><h1 class=post-title>lvm逻辑卷管理</h1><div class=post-meta>8 min&nbsp;·&nbsp;1537 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/post/lvm%e9%80%bb%e8%be%91%e5%8d%b7%e7%ae%a1%e7%90%86.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#lvm常用的术语>LVM常用的术语</a><ul><li><a href=#lvm主要元素构成><strong>LVM主要元素构成：</strong></a></li><li><a href=#lvm优点>LVM优点</a></li></ul></li><li><a href=#创建lvm的基本步骤>创建LVM的基本步骤</a><ul><li><a href=#lvm常用的命令>lvm常用的命令</a></li></ul></li></ul></nav></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=lvm的工作原理>LVM的工作原理<a hidden class=anchor aria-hidden=true href=#lvm的工作原理>#</a></h1><p><strong>LVM（ Logical Volume Manager）逻辑卷管理，是在磁盘分区和文件系统之间添加的一个逻辑层，来为文件系统屏蔽下层磁盘分区布局，提供一个抽象的盘卷，在盘卷上建立文件系统。管理员利用LVM可以在磁盘不用重新分区的情况下动态调整文件系统的大小，并且利用LVM管理的文件系统可以跨越磁盘，当服务器添加了新的磁盘后，管理员不必将原有的文件移动到新的磁盘上，而是通过LVM可以直接扩展文件系统跨越磁盘</strong></p><p><strong>它就是通过将底层的物理硬盘封装起来，然后以逻辑卷的方式呈现给上层应用。在LVM中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不再是针对于分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。</strong></p><h2 id=lvm常用的术语>LVM常用的术语<a hidden class=anchor aria-hidden=true href=#lvm常用的术语>#</a></h2><p><strong>物理存储介质（The physical media）:LVM存储介质可以是磁盘分区，整个磁盘，RAID阵列或SAN磁盘，设备必须初始化为LVM物理卷，才能与LVM结合使用</strong></p><p><strong>物理卷<strong><strong>PV</strong></strong>（physical volume） ：物理卷就是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数,创建物理卷它可以用硬盘分区，也可以用硬盘本身；</strong></p><p><strong>卷组<strong><strong>VG</strong></strong>（Volume Group） ：一个LVM卷组由一个或多个物理卷组成 </strong></p><p><strong>逻辑卷<strong><strong>LV</strong></strong>（logical volume） ：LV建立在VG之上，可以在LV之上建立文件系统</strong></p><p><strong>PE（physical extents） ：<strong><strong>PV物理卷</strong></strong>中可以分配的最小存储单元，PE的大小是可以指定的，默认为4MB</strong></p><p><strong>LE（logical extent） ：</strong> <strong>LV逻辑卷****中可以分配的最小存储单元，在同一个卷组中，LE的大小和PE是相同的，并且一一对应</strong></p><p><strong>最小存储单位总结：</strong></p><p><strong>名称 最小存储单位</strong></p><p><strong>硬盘 扇区（512字节）</strong></p><p><strong>文件系统 block（1K或4K ）# mkfs.ext4 -b 2048 /dev/sdb1 ，最大支持到4096</strong></p><p><strong>raid chunk （512K） #mdadm -C -v /dev/md5 -l 5 -n 3 -c 512 -x 1 /dev/sde{1,2,3,5}</strong></p><p><strong>LVM PE （4M） # vgcreate -s 4M vg1 /dev/sdb{1,2}</strong></p><h3 id=lvm主要元素构成><strong>LVM主要元素构成：</strong><a hidden class=anchor aria-hidden=true href=#lvm主要元素构成>#</a></h3><p><strong>总结：多个磁盘/分区/raid-》多个物理卷PV-》合成卷组VG-》从VG划出逻辑卷LV-》格式化LV挂载使用</strong></p><h3 id=lvm优点>LVM优点<a hidden class=anchor aria-hidden=true href=#lvm优点>#</a></h3><p><strong>使用卷组，使多个硬盘空间看起来像是一个大的硬盘</strong></p><p><strong>使用逻辑卷，可以跨多个硬盘空间的分区 sdb1 sdb2 sdc1 sdd2 sdf</strong></p><p><strong>在使用逻辑卷时，它可以在空间不足时动态调整它的大小</strong></p><p><strong>在调整逻辑卷大小时，不需要考虑逻辑卷在硬盘上的位置，不用担心没有可用的连续空间</strong></p><p><strong>可以在线对LV,VG 进行创建，删除，调整大小等操作。LVM上的文件系统也需要重新调整大小。</strong></p><p><strong>允许创建快照，可以用来保存文件系统的备份。</strong></p><p><strong>RAID+LVM一起用：LVM是软件的卷管理方式，而RAID是磁盘管理的方法。对于重要的数据，使用RAID来保护物理的磁盘不会因为故障而中断业务，再用LVM用来实现对卷的良性的管理，更好的利用磁盘资源。</strong></p><h2 id=创建lvm的基本步骤>创建LVM的基本步骤<a hidden class=anchor aria-hidden=true href=#创建lvm的基本步骤>#</a></h2><p><strong>1) 物理磁盘被格式化为PV，(空间被划分为一个个的PE)</strong> <strong>#PV包含PE</strong></p><p><strong>2) 不同的PV加入到同一个VG中，(不同PV的PE全部进入到了VG的PE池内)</strong> <strong>#VG包含PV</strong></p><p><strong>3) 在VG中创建LV逻辑卷，基于PE创建，(组成LV的PE可能来自不同的物理磁盘)</strong> <strong>#LV基于PE创建</strong></p><p><strong>4) LV直接可以格式化后挂载使用</strong> <strong>#格式化挂载使用</strong></p><p><strong>5) LV的扩充缩减实际上就是增加或减少组成该LV的PE数量，其过程不会丢失原始数据</strong></p><h3 id=lvm常用的命令>lvm常用的命令<a hidden class=anchor aria-hidden=true href=#lvm常用的命令>#</a></h3><p><strong>下面的操作会用的一些查看命令：</strong></p><p><strong>创建并使用LVM逻辑卷</strong></p><h4 id=1-创建pv><strong>1、 创建PV</strong><a hidden class=anchor aria-hidden=true href=#1-创建pv>#</a></h4><p><strong>添加一个sdb磁盘</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># fdisk /dev/sdb   #创建4个主分区，每个分区1G</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># ls /dev/sdb\</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/dev/sdb /dev/sdb1 /dev/sdb2 /dev/sdb3 /dev/sdb4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#设定分区类型代码：fdisk /dev/sdb ===&gt; t ===&gt; 选择分区号 ====&gt; 8e ====&gt; w</span>
</span></span><span class=line><span class=cl><span class=c1>#注：现在系统已经很智能了， 直接使用默认的 83 Linux分区，也可以创建pv的。</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvcreate /dev/sdb{1,2,3,4}  #创建pv</span>
</span></span><span class=line><span class=cl>Physical volume <span class=s2>&#34;/dev/sdb1&#34;</span> successfully created.
</span></span><span class=line><span class=cl>Physical volume <span class=s2>&#34;/dev/sdb2&#34;</span> successfully created.
</span></span><span class=line><span class=cl>Physical volume <span class=s2>&#34;/dev/sdb3&#34;</span> successfully created.
</span></span><span class=line><span class=cl>Physical volume <span class=s2>&#34;/dev/sdb4&#34;</span> successfully created.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvdisplay /dev/sdb1  </span>
</span></span><span class=line><span class=cl><span class=c1>#查看物理卷信息</span>
</span></span><span class=line><span class=cl> <span class=s2>&#34;/dev/sdb1&#34;</span> is a new physical volume of <span class=s2>&#34;1.00 GiB&#34;</span>
</span></span><span class=line><span class=cl> --- NEW Physical volume ---
</span></span><span class=line><span class=cl> PV Name        /dev/sdb1
</span></span><span class=line><span class=cl> VG Name       
</span></span><span class=line><span class=cl> PV Size        1.00 GiB
</span></span><span class=line><span class=cl> Allocatable      NO
</span></span><span class=line><span class=cl> PE Size        <span class=m>0</span> 
</span></span><span class=line><span class=cl> Total PE       <span class=m>0</span>
</span></span><span class=line><span class=cl> Free PE        <span class=m>0</span>
</span></span><span class=line><span class=cl> Allocated PE     <span class=m>0</span>
</span></span><span class=line><span class=cl> PV UUID        SHKFwf-WsLr-kkox-wlee-dAXc-5eL0-hyhaTV
</span></span></code></pre></div><h4 id=2创建vg卷组>2、<strong>创建vg卷组：</strong><a hidden class=anchor aria-hidden=true href=#2创建vg卷组>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 语法：   vgcreate vg名字 pv的名字  可以跟多个pv</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgcreate vg01 /dev/sdb1</span>
</span></span><span class=line><span class=cl> Volume group <span class=s2>&#34;vg01&#34;</span> successfully created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgs</span>
</span></span><span class=line><span class=cl> VG  <span class=c1>#PV #LV #SN Attr  VSize  VFree </span>
</span></span><span class=line><span class=cl> vg01  <span class=m>1</span>  <span class=m>0</span>  <span class=m>0</span> wz--n- 1020.00m 1020.00m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgdisplay vg01</span>
</span></span><span class=line><span class=cl> --- Volume group ---
</span></span><span class=line><span class=cl> VG Name        vg01
</span></span><span class=line><span class=cl> System ID      
</span></span><span class=line><span class=cl> Format        lvm2
</span></span><span class=line><span class=cl> Metadata Areas    <span class=m>1</span>
</span></span><span class=line><span class=cl> Metadata Sequence No <span class=m>1</span>
</span></span><span class=line><span class=cl> VG Access       read/write
</span></span><span class=line><span class=cl> VG Status       resizable
</span></span><span class=line><span class=cl> MAX LV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Cur LV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Open LV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Max PV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Cur PV        <span class=m>1</span>
</span></span><span class=line><span class=cl> Act PV        <span class=m>1</span>
</span></span><span class=line><span class=cl> VG Size        1020.00 MiB
</span></span><span class=line><span class=cl> PE Size        4.00 MiB
</span></span><span class=line><span class=cl> Total PE       <span class=m>255</span>
</span></span><span class=line><span class=cl> Alloc PE / Size    <span class=m>0</span> / <span class=m>0</span> 
</span></span></code></pre></div><h4 id=3创建lv>3、<strong>创建LV</strong><a hidden class=anchor aria-hidden=true href=#3创建lv>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>lvcreate -n 指定新逻辑卷的名称 -L指定lv大小的SIZE<span class=o>(</span>M,G<span class=o>)</span> （-l：小l 指定LE的数量） vgname
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvcreate -n lv01 -L 16M vg01</span>
</span></span><span class=line><span class=cl> Logical volume <span class=s2>&#34;lv01&#34;</span> created.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvcreate -n lv02 -l 4 vg01</span>
</span></span><span class=line><span class=cl> Logical volume <span class=s2>&#34;lv02&#34;</span> created.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvs</span>
</span></span><span class=line><span class=cl> LV  VG  Attr    LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert
</span></span><span class=line><span class=cl> lv01 vg01 -wi-a----- 16.00m                          
</span></span><span class=line><span class=cl> lv02 vg01 -wi-a----- 16.00m                     
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvdisplay /dev/sdb1</span>
</span></span><span class=line><span class=cl> --- Physical volume ---
</span></span><span class=line><span class=cl> PV Name        /dev/sdb1
</span></span><span class=line><span class=cl> VG Name        vg01
</span></span><span class=line><span class=cl> PV Size        1.00 GiB / not usable 4.00 MiB
</span></span><span class=line><span class=cl> Allocatable      yes
</span></span><span class=line><span class=cl> PE Size        4.00 MiB
</span></span><span class=line><span class=cl> Total PE       <span class=m>255</span>
</span></span><span class=line><span class=cl> Free PE        <span class=m>247</span>
</span></span><span class=line><span class=cl> Allocated PE     <span class=m>8</span>  <span class=c1># Allocated   [&#39;æləkeɪtɪd] 分配 ，已经使用了8个PE</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgdisplay vg01</span>
</span></span><span class=line><span class=cl> Alloc PE / Size    <span class=m>8</span> / 32.00 MiB  <span class=c1>#已经使用8个PE，32MB</span>
</span></span><span class=line><span class=cl> Free PE / Size    <span class=m>247</span> / 988.00 MiB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 
</span></span></code></pre></div><h4 id=4文件系统格式与挂载><strong>4、文件系统格式与挂载</strong><a hidden class=anchor aria-hidden=true href=#4文件系统格式与挂载>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># mkdir /lv01</span>
</span></span><span class=line><span class=cl>互动： lv01 逻辑卷的路径在哪？
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># ls /dev/vg01/  #查看逻辑卷</span>
</span></span><span class=line><span class=cl>lv01 lv02
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># ll /dev/vg01/lv01 #其实lv01是dm-0的软链接</span>
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>7</span> 5月 <span class=m>18</span> 19:02 /dev/vg01/lv01 -&gt; ../dm-0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># mkfs.ext4 /dev/vg01/lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># mount /dev/vg01/lv01 /lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># df -Th /lv01</span>
</span></span><span class=line><span class=cl>文件系统       类型 容量 已用 可用 已用% 挂载点
</span></span><span class=line><span class=cl>/dev/mapper/vg01-lv01 ext4  15M 268K  14M  2% /lv01
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1>#echo &#34;/dev/vg01/lv01 /lv01 ext4 defaults 0 0&#34; &gt;&gt; /etc/fstab</span>
</span></span></code></pre></div><h4 id=5指定pe大小用><strong>5、指定PE大小用</strong><a hidden class=anchor aria-hidden=true href=#5指定pe大小用>#</a></h4><p><strong>指定PE大小用的参数： -s ,如果存储的数据都是大文件，那么PE尽量调大，读取速度快</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgcreate -s 16M vg02 /dev/sdb2</span>
</span></span><span class=line><span class=cl> Volume group <span class=s2>&#34;vg02&#34;</span> successfully created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PE的大小只有为2的幂数，且最大为512M</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgdisplay vg02</span>
</span></span><span class=line><span class=cl> --- Volume group ---
</span></span><span class=line><span class=cl> VG Name        vg02
</span></span><span class=line><span class=cl> System ID      
</span></span><span class=line><span class=cl> Format        lvm2
</span></span><span class=line><span class=cl> Metadata Areas    <span class=m>1</span>
</span></span><span class=line><span class=cl> Metadata Sequence No <span class=m>1</span>
</span></span><span class=line><span class=cl> VG Access       read/write
</span></span><span class=line><span class=cl> VG Status       resizable
</span></span><span class=line><span class=cl> MAX LV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Cur LV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Open LV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Max PV        <span class=m>0</span>
</span></span><span class=line><span class=cl> Cur PV        <span class=m>1</span>
</span></span><span class=line><span class=cl> Act PV        <span class=m>1</span>
</span></span><span class=line><span class=cl> VG Size        1008.00 MiB
</span></span><span class=line><span class=cl> PE Size        16.00 MiB  <span class=c1>#已经是16MB**</span>
</span></span></code></pre></div><h4 id=6lv扩容><strong>6、LV扩容</strong><a hidden class=anchor aria-hidden=true href=#6lv扩容>#</a></h4><p><strong>首先，确定一下是否有可用的扩容空间，因为空间是从VG里面创建的，并且LV不能跨VG扩容</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> <span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgs</span>
</span></span><span class=line><span class=cl> VG  <span class=c1>#PV #LV #SN Attr  VSize  VFree </span>
</span></span><span class=line><span class=cl> vg01  <span class=m>1</span>  <span class=m>2</span>  <span class=m>0</span> wz--n- 1020.00m 988.00m
</span></span><span class=line><span class=cl> vg02  <span class=m>1</span>  <span class=m>0</span>  <span class=m>0</span> wz--n- 1008.00m 1008.00m**
</span></span></code></pre></div><p><strong>用的命令如下：</strong></p><p><strong>扩容逻辑卷</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1>#  lvextend -L +30m /dev/vg01/lv01</span>
</span></span></code></pre></div><p><strong>说明：在指定大小的时候，扩容30m和扩容到30m是不一样的写法</strong></p><p><strong>扩容30m ====> -L +30M</strong></p><p><strong>扩容到30m =====> -L 30M</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvextend -L +30m /dev/vg01/lv01  </span>
</span></span><span class=line><span class=cl> Rounding size to boundary between physical extents: 32.00 MiB.
</span></span><span class=line><span class=cl> Size of logical volume vg01/lv01 changed from 16.00 MiB <span class=o>(</span><span class=m>4</span> extents<span class=o>)</span> to 48.00 MiB <span class=o>(</span><span class=m>12</span> extents<span class=o>)</span>.
</span></span><span class=line><span class=cl> Logical volume vg01/lv01 successfully resized.**
</span></span></code></pre></div><hr><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvs</span>
</span></span><span class=line><span class=cl> LV  VG  Attr    LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert
</span></span><span class=line><span class=cl> lv01 vg01 -wi-ao---- 48.00m   <span class=c1>#LV已经扩容成功                        </span>
</span></span><span class=line><span class=cl> lv02 vg01 -wi-a----- 16.00m 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># df -Th /lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>文件系统       类型 容量 已用 可用 已用% 挂载点
</span></span><span class=line><span class=cl>/dev/mapper/vg01-lv01 ext4  15M 268K  14M  2% /lv01
</span></span></code></pre></div><p><strong>注：可以看到LV虽然扩展了，但是文件系统大小还是原来的，下面开始扩容文件系统</strong></p><p><strong>ext4文件系统扩容使用命令语法： resize2fs 逻辑卷名称</strong></p><p><strong>xfs文件系统扩容使用命令语法： xfs_growfs 挂载点 xfs_growfs /var/</strong></p><p><strong>resize2fs和xfs_growfs 两者的区别是传递的参数不一样的，xfs_growfs是采用的挂载点；resize2fs是逻辑卷名称，而且resize2fs命令不能对xfs类型文件系统使用</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># resize2fs /dev/vg01/lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>resize2fs 1.42.9 <span class=o>(</span>28-Dec-2013<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Filesystem at /dev/vg01/lv01 is mounted on /lv01<span class=p>;</span> on-line resizing required
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>old_desc_blocks</span> <span class=o>=</span> 1, <span class=nv>new_desc_blocks</span> <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The filesystem on /dev/vg01/lv01 is now <span class=m>49152</span> blocks long.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># df -Th /lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>文件系统       类型 容量 已用 可用 已用% 挂载点
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/dev/mapper/vg01-lv01 ext4  46M （扩容成功）522K  43M  2% /lv01
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvextend -L 80M -r /dev/vg01/lv01  #直接扩容到80M空间，一步到位，不用再扩文件系统了</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># df -T /lv01/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>文件系统       类型 1K-块 已用 可用 已用% 挂载点
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/dev/mapper/vg01-lv01 ext4 <span class=m>78303</span>  <span class=m>776</span> <span class=m>73761</span>  2% /lv01
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># df -Th /lv01/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>文件系统       类型 容量 已用 可用 已用% 挂载点
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/dev/mapper/vg01-lv01 ext4  77M 776K  73M  2% /lv01**
</span></span></code></pre></div><h4 id=7vg扩容><strong>7、VG扩容</strong><a hidden class=anchor aria-hidden=true href=#7vg扩容>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> VG  <span class=c1>#PV #LV #SN Attr  VSize  VFree </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> vg01  <span class=m>1</span>  <span class=m>2</span>  <span class=m>0</span> wz--n- 1020.00m 924.00m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> vg02  <span class=m>1</span>  <span class=m>0</span>  <span class=m>0</span> wz--n- 1008.00m 1008.00m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># vg扩容的场景：vg卷组中的空间不了够，需要添加新的硬盘进来</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvcreate /dev/sdb3 # 创建pv</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgextend vg01 /dev/sdb3 #扩容成功</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Volume group <span class=s2>&#34;vg01&#34;</span> successfully extended
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> VG  <span class=c1>#PV #LV #SN Attr  VSize  VFree </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> vg01  <span class=m>2</span>  <span class=m>2</span>  <span class=m>0</span> wz--n-  1.99g  &lt;1.90g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> vg02  <span class=m>1</span>  <span class=m>0</span>  <span class=m>0</span> wz--n- 1008.00m 1008.00m
</span></span></code></pre></div><h4 id=8lvm缩小><strong>8、LVM缩小</strong><a hidden class=anchor aria-hidden=true href=#8lvm缩小>#</a></h4><p><strong>互动：LVM可以动态增加，可以动态缩小吗？</strong></p><p><strong>答：LVM可以动态增加，也可以动态缩小，但是XFS不支持动态缩小，所以我们无法实现基于xfs的动态缩小。btrfs文件系统支持在线缩小。</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> <span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvreduce -L -20m /dev/vg01/lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> WARNING: Reducing active and open logical volume to 60.00 MiB.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> THIS MAY DESTROY YOUR DATA <span class=o>(</span>filesystem etc.<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Do you really want to reduce vg01/lv01? <span class=o>[</span>y/n<span class=o>]</span>: y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Size of logical volume vg01/lv01 changed from 80.00 MiB <span class=o>(</span><span class=m>20</span> extents<span class=o>)</span> to 60.00 MiB <span class=o>(</span><span class=m>15</span> extents<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Logical volume vg01/lv01 successfully resized.  <span class=c1>#缩小成功**</span>
</span></span></code></pre></div><p><strong>但是文件系统没有缩小成功：</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># df -h /lv01/</span>
</span></span><span class=line><span class=cl>文件系统          容量 已用 可用 已用% 挂载点
</span></span><span class=line><span class=cl>/dev/mapper/vg01-lv01  77M 776K  73M  2% /lv01  <span class=c1>#发现文件系统上空间没有变</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvextend -L 10M -r /dev/vg01/lv01 #这两个命令也是不能执行成功的</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># resize2fs /dev/vg01/lv01  #这两个命令也是不能执行成功的</span>
</span></span></code></pre></div><p><strong>VG的缩减，要保证你的物理卷是否被使用，是因为它无法缩减一个正在使用的PV</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgs</span>
</span></span><span class=line><span class=cl> VG  <span class=c1>#PV #LV #SN Attr  VSize  VFree </span>
</span></span><span class=line><span class=cl> vg01  <span class=m>2</span>  <span class=m>2</span>  <span class=m>0</span> wz--n-  1.99g  &lt;1.92g
</span></span><span class=line><span class=cl> vg02  <span class=m>1</span>  <span class=m>0</span>  <span class=m>0</span> wz--n- 1008.00m 1008.00m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvs</span>
</span></span><span class=line><span class=cl> PV     VG  Fmt Attr PSize  PFree 
</span></span><span class=line><span class=cl> /dev/sdb1 vg01 lvm2 a-- 1020.00m 944.00m
</span></span><span class=line><span class=cl> /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m
</span></span><span class=line><span class=cl> /dev/sdb3 vg01 lvm2 a-- 1020.00m 1020.00m
</span></span><span class=line><span class=cl> /dev/sdb4    lvm2 ---   1.00g  1.00g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># cp -r /boot/grub /lv01/  #复制一些测试数据</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgreduce vg01 /dev/sdb1  #将sdb1移出失败，因sdb1正在被使用</span>
</span></span><span class=line><span class=cl> Physical volume <span class=s2>&#34;/dev/sdb1&#34;</span> still in use**
</span></span></code></pre></div><p><strong>互动：如果sdb1是一个磁盘阵列，而这个磁盘阵列使用年代太久，我们必须移出怎么办？</strong></p><p><strong>移动数据：</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvmove /dev/sdb1  /dev/sdb3 #将sdb1上数据移到新增加sdb3 pv 上</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb1: Moved: 23.53%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb1: Moved: 76.47%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb1: Moved: 100.00%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgreduce vg01 /dev/sdb1 #移完数据再移出</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Removed <span class=s2>&#34;/dev/sdb1&#34;</span> from volume group <span class=s2>&#34;vg01&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> PV     VG  Fmt Attr PSize  PFree 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb1    lvm2 ---   1.00g  1.00g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb3 vg01 lvm2 a-- 1020.00m 952.00m <span class=c1>#vg01中只有sdb3了</span>
</span></span></code></pre></div><h4 id=9-lvm删除><strong>9、 LVM删除</strong><a hidden class=anchor aria-hidden=true href=#9-lvm删除>#</a></h4><p><strong>创建LVM流程:</strong></p><p><strong>pvcreate创建pv -> vgcreate创建卷组 -> lvcreate创建逻辑卷 -> mkfs.xfs lv 格式化-> mount挂载</strong></p><p><strong>删除LVM流程：</strong></p><p><strong>umount卸载 -> lvremove lv移出卷组中所有逻辑卷-> vgremove vg移出卷组-> pvremove 移出pv</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># umount /lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvremove /dev/vg01/lv01</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Do you really want to remove active logical volume vg01/lv01? <span class=o>[</span>y/n<span class=o>]</span>: y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Logical volume <span class=s2>&#34;lv01&#34;</span> successfully removed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># lvs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> LV  VG  Attr    LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> lv02 vg01 -wi-a----- 16.00m     <span class=c1>#已经看不到lv01                      </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgremove vg01  #直接移出卷组</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Do you really want to remove volume group <span class=s2>&#34;vg01&#34;</span> containing <span class=m>1</span> logical volumes? <span class=o>[</span>y/n<span class=o>]</span>: y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Do you really want to remove active logical volume vg01/lv02? <span class=o>[</span>y/n<span class=o>]</span>: y 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#如果卷组中还有lv，移出时，会提示，是否也移出，咱们这里直接移出</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Logical volume <span class=s2>&#34;lv02&#34;</span> successfully removed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Volume group <span class=s2>&#34;vg01&#34;</span> successfully removed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># vgs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> VG  <span class=c1>#PV #LV #SN Attr  VSize  VFree </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> vg02  <span class=m>1</span>  <span class=m>0</span>  <span class=m>0</span> wz--n- 1008.00m 1008.00m  <span class=c1>#没有vg01</span>
</span></span></code></pre></div><p><strong>移出pv sdb1</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> PV     VG  Fmt Attr PSize  PFree 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb1    lvm2 ---   1.00g  1.00g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb3    lvm2 ---   1.00g  1.00g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb4    lvm2 ---   1.00g  1.00g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvremove /dev/sdb1  #已经移出</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Labels on physical volume <span class=s2>&#34;/dev/sdb1&#34;</span> successfully wiped.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@xuegod63 ~<span class=o>]</span><span class=c1># pvs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> PV     VG  Fmt Attr PSize  PFree 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb2 vg02 lvm2 a-- 1008.00m 1008.00m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb3    lvm2 ---   1.00g  1.00g
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> /dev/sdb4    lvm2 ---   1.00g  1.00g
</span></span></code></pre></div><p><strong>15.3 实战-使用SSM工具为公司的邮件服务器创建可动态扩容的存储池</strong></p><p><strong>安装SSM</strong> <strong>ssm工具了一下</strong></p><p><strong>[root@xuegod63 ~]# yum -y install system-storage-manager</strong></p><p><strong>SSM：检查关于可用硬驱和LVM卷的信息。显示关于现有磁盘存储设备、存储池、LVM卷和存储快照的信息。</strong></p><p><strong>15.3.1 查看磁盘信息</strong></p><p><strong>列出设备信息</strong></p><p><strong>root@xuegod63 ~]# ssm list dev</strong></p><p><strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</strong></p><p><strong>Device Free Used Total Pool Mount point</strong></p><p><strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</strong></p><p><strong>/dev/fd0 4.00 KB</strong></p><p><strong>/dev/sda 20.00 GB PARTITIONED</strong></p><p><strong>/dev/sda1 200.00 MB /boot</strong></p><p><strong>/dev/sda2 1.00 GB SWAP</strong></p><p><strong>/dev/sda3 10.00 GB /</strong></p><p><strong>/dev/sdb 20.00 GB</strong></p><p><strong>/dev/sdb1 1.00 GB</strong></p><p><strong>/dev/sdb2 1008.00 MB 0.00 KB 1.00 GB vg02</strong></p><p><strong>/dev/sdb3 1.00 GB</strong></p><p><strong>/dev/sdb4 1.00 GB</strong></p><p><strong>存储池信息</strong></p><p><strong>[root@xuegod63 ~]# ssm list pool</strong></p><p><strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</strong></p><p><strong>Pool Type Devices Free Used Total</strong></p><p><strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</strong></p><p><strong>vg02 lvm 1 1008.00 MB 0.00 KB 1008.00 MB</strong></p><p><strong>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-</strong></p><p><strong>15.3.2 实战：为公司的邮件服务器创建基于LVM的邮件存储</strong></p><p><strong>实战场景：公司要搭建一台邮件服务器，考虑到后期公司发展规模扩张，需要你创建一个名为mail 的LVM存储池，并在其上创建一个名为mail-lv，初始大小为1G的lvm卷，格式化为xfs文件系统，并将其挂载/mail-lv目录下。此存储池中的空间后期要可以动态扩容。</strong></p><p><strong>将sdb上所有卷组信息删除：</strong></p><p><strong>[root@xuegod63 ~]# vgremove vg02</strong></p><p><strong>[root@xuegod63 ~]# pvremove /dev/sdb{1,2,3,4}</strong></p><p><strong>创建目录</strong></p><p><strong>[root@xuegod72 ~]# mkdir /mail-lv</strong></p><p><strong>用的命令如下：</strong></p><p><strong>ssm create -s</strong> <strong>lv大小</strong> <strong>-n</strong> <strong>lv名称</strong> <strong>&ndash;fstype</strong> <strong>lv文件系统类型</strong> <strong>-p</strong> <strong>卷组名</strong> <strong>设备</strong> <strong>挂载点</strong></p><p><strong>自动把设备变成pv，创建vg , lv ,格式化文件系统, 自动挂载</strong></p><p><strong>[root@xuegod63 ~]#</strong> <strong>ssm create -s 1G -n mail-lv &ndash;fstype xfs -p mail /dev/sdb[1-4] /mail-lv</strong></p><p><strong>Physical volume &ldquo;/dev/sdb1&rdquo; successfully created.</strong></p><p><strong>Physical volume &ldquo;/dev/sdb2&rdquo; successfully created.</strong></p><p><strong>Physical volume &ldquo;/dev/sdb3&rdquo; successfully created.</strong></p><p><strong>Physical volume &ldquo;/dev/sdb4&rdquo; successfully created.</strong></p><p><strong>Volume group &ldquo;mail&rdquo; successfully created</strong></p><p><strong>WARNING: ext4 signature detected on /dev/mail/mail-lv at offset 1080. Wipe it? [y/n]:</strong> <strong>y</strong></p><p><strong>Wiping ext4 signature on /dev/mail/mail-lv.</strong></p><p><strong>Logical volume &ldquo;mail-lv&rdquo; created.</strong></p><p><strong>meta-data=/dev/mail/mail-lv isize=512 agcount=4, agsize=65536 blks</strong></p><p>​ <strong>= sectsz=512 attr=2, projid32bit=1</strong></p><p>​ <strong>= crc=1 finobt=0, sparse=0</strong></p><p><strong>data = bsize=4096 blocks=262144, imaxpct=25</strong></p><p>​ <strong>= sunit=0 swidth=0 blks</strong></p><p><strong>naming =version 2 bsize=4096 ascii-ci=0 ftype=1</strong></p><p><strong>log =internal log bsize=4096 blocks=2560, version=2</strong></p><p>​ <strong>= sectsz=512 sunit=0 blks, lazy-count=1</strong></p><p><strong>realtime =none extsz=4096 blocks=0, rtextents=0</strong></p><p><strong>[root@xuegod63 ~]# df -h /mail-lv/</strong></p><p><strong>文件系统 容量 已用 可用 已用% 挂载点</strong></p><p><strong>/dev/mapper/mail-mail&ndash;lv 1014M 33M 982M 4% /mail-lv</strong></p><p><strong>总结：</strong></p><p><strong>15.1 LVM的工作原理</strong></p><p><strong>15.2 创建LVM的基本步骤</strong></p><p><strong>15.3 实战-使用SSM工具为公司的邮件服务器创建可动态扩容的存储池</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wandong1.github.io/tags/linux/>linux</a></li></ul><nav class=paginav><a class=prev href=https://wandong1.github.io/post/linux%E7%B3%BB%E7%BB%9F%E8%B4%9F%E8%BD%BD%E9%AB%98%E6%8E%92%E6%9F%A5/><span class=title>« Prev Page</span><br><span>linux系统负载高排查</span></a>
<a class=next href=https://wandong1.github.io/post/mysql%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3/><span class=title>Next Page »</span><br><span>mysql安装文档</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share lvm逻辑卷管理 on twitter" href="https://twitter.com/intent/tweet/?text=lvm%e9%80%bb%e8%be%91%e5%8d%b7%e7%ae%a1%e7%90%86&url=https%3a%2f%2fwandong1.github.io%2fpost%2flvm%25E9%2580%25BB%25E8%25BE%2591%25E5%258D%25B7%25E7%25AE%25A1%25E7%2590%2586%2f&hashtags=linux"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share lvm逻辑卷管理 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwandong1.github.io%2fpost%2flvm%25E9%2580%25BB%25E8%25BE%2591%25E5%258D%25B7%25E7%25AE%25A1%25E7%2590%2586%2f&title=lvm%e9%80%bb%e8%be%91%e5%8d%b7%e7%ae%a1%e7%90%86&summary=lvm%e9%80%bb%e8%be%91%e5%8d%b7%e7%ae%a1%e7%90%86&source=https%3a%2f%2fwandong1.github.io%2fpost%2flvm%25E9%2580%25BB%25E8%25BE%2591%25E5%258D%25B7%25E7%25AE%25A1%25E7%2590%2586%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share lvm逻辑卷管理 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwandong1.github.io%2fpost%2flvm%25E9%2580%25BB%25E8%25BE%2591%25E5%258D%25B7%25E7%25AE%25A1%25E7%2590%2586%2f&title=lvm%e9%80%bb%e8%be%91%e5%8d%b7%e7%ae%a1%e7%90%86"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share lvm逻辑卷管理 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwandong1.github.io%2fpost%2flvm%25E9%2580%25BB%25E8%25BE%2591%25E5%258D%25B7%25E7%25AE%25A1%25E7%2590%2586%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share lvm逻辑卷管理 on whatsapp" href="https://api.whatsapp.com/send?text=lvm%e9%80%bb%e8%be%91%e5%8d%b7%e7%ae%a1%e7%90%86%20-%20https%3a%2f%2fwandong1.github.io%2fpost%2flvm%25E9%2580%25BB%25E8%25BE%2591%25E5%258D%25B7%25E7%25AE%25A1%25E7%2590%2586%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share lvm逻辑卷管理 on telegram" href="https://telegram.me/share/url?text=lvm%e9%80%bb%e8%be%91%e5%8d%b7%e7%ae%a1%e7%90%86&url=https%3a%2f%2fwandong1.github.io%2fpost%2flvm%25E9%2580%25BB%25E8%25BE%2591%25E5%258D%25B7%25E7%25AE%25A1%25E7%2590%2586%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://wandong1.github.io>万东的云计算运维博客</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>